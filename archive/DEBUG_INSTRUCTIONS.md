# 🚀 検証とデバッグの実行手順

## 1. 📊 CSVデータ構造の確認

### 手順：
1. ブラウザで `csv_analyzer.html` を開く
2. `inspection_data.csv` ファイルを選択
3. 「CSVファイルを分析」ボタンをクリック
4. 「GASロジックをシミュレート」ボタンをクリック

### 確認ポイント：
- ✅ 「前々々回指示数」列が存在するか
- ✅ P000001, R000003 のデータに前々々回指示数の値があるか
- ✅ 数値として解析可能か

## 2. 🔧 Google Apps Script でのデバッグ

### Google Apps Script エディタで実行する関数：

```javascript
// スプレッドシート構造の詳細確認
inspectSpreadsheetStructure();

// 特定データの確認
inspectSpecificData('P000001', 'R000003');

// 従来のデバッグ関数
debugSpreadsheetStructure();
```

### 確認ポイント：
- ✅ スプレッドシートのヘッダー構造
- ✅ 前々々回指示数列の存在とインデックス
- ✅ 実際のデータの値と型

## 3. 🧪 クライアント側動作確認

### 手順：
1. ブラウザで `test_meter_reading.html` を開く
2. 各テストボタンをクリックして動作確認

### 確認ポイント：
- ✅ 差分計算ロジックの動作
- ✅ threeTimesPrevious が undefined の場合の処理
- ✅ デバッグ情報の表示

## 4. 🔄 実際のアプリケーションでのテスト

### 手順：
1. Google Apps Script の Web App URL で実際にアクセス
2. P000001 → R000003 を選択
3. ブラウザの開発者ツールでコンソールログを確認

### 確認ポイント：
- ✅ サーバーからのレスポンス構造
- ✅ threeTimesPrevious の値
- ✅ 差分計算の実行結果

## 5. 📝 問題修正後のチェックリスト

### サーバー側：
- [ ] 「前々々回指示数」列が正しく検出される
- [ ] threeTimesPrevious に正しい値が設定される
- [ ] デバッグ情報が適切に返される

### クライアント側：
- [ ] 前々回と前々々回の差分が正しく計算される
- [ ] 差分が "前々回" 列に `[+20]` 形式で表示される
- [ ] デバッグ情報が画面に表示される

## 6. 🎯 期待される最終結果

### 表示例：
```
検針日時    今回(㎥)  前回      前々回        今回使用量  状態
2025/05/31  1208     1186[+16] 1170[+20]    22         正常
```

### ログ例：
```
[meter_reading] 差分計算結果: diff=20, 更新後prevPrevReadingText=1170[+20]
[meter_reading] Server Debug Info: threeTimesPreviousExists: true
```

---

**注意:** Google Apps Script の実行環境でのみ、実際のスプレッドシートデータを確認できます。
ローカルでの分析は参考情報として使用してください。
